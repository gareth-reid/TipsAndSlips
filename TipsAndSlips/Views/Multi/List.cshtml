@model List<Entities.MultiBuilder>
@{
    ViewData["Title"] = "List Multis";
}
@{
    var multis = (List<Entities.MultiBuilder>)ViewData["ListMultiData"]; // Cast the list
}
@section Scripts {
    <link rel="stylesheet" href="~/css/multi.css" />
    <script type="text/javascript">
        $(document).ready(function () {
            var startDates = $('.date-to-be-converted')
            startDates.each(function (e) {
                var localDate = new Date($(this).html());                
                var localDateFormatted = $.format.date(localDate, "dd/MM/yyyy hh:mm a")
                $(this).html(localDateFormatted)
            });            
        });
    </script>
}

<div class="text-center">
    <h1 class="display-4">Multis</h1>
    <p>AutoGenerated Multis.</p>

    <div class="multi-cart">        
        <a asp-controller="Multi" asp-action="UpdateResultsAll" class="btn btn-success">Update Results</a>
        <ul class="list-group">
            @foreach (var multi in @multis) // Print the list
            {
                <li class="list-group-item">
                    <a class="nav-link text-dark" asp-area="" asp-controller="Multi" asp-action="Index" asp-route-id="@multi.MultiBuilderId">
                        <div class="container">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col">
                                    @multi.MultiName
                                    <p class="mb-1 multi-grid-text-details">
                                        <b>@multi.FinalMarkets.Count(m => m.Status == "WINNER" || m.Status == "REMOVED" || m.Status == "REMOVED_VACANT")/@multi.FinalMarkets.Count</b> Legs Won
                                        @if (@multi.FinalMarkets.Count(m => m.Status == "OPEN" || m.Status == "ACTIVE") > 0)
                                        {
                                            <span class="badge badge-pill badge-info">
                                                <b>Active</b>
                                            </span>
                                        }
                                        else if (@multi.FinalMarkets.Count(m => m.Status == "WINNER" || m.Status == "REMOVED" || m.Status == "REMOVED_VACANT") == @multi.FinalMarkets.Count)
                                        {
                                            <span class="badge badge-pill badge-success">
                                                <b>Winner</b>
                                            </span>
                                        }
                                        else
                                        {
                                            <span class="badge badge-pill badge-custom">
                                                <b>Loss</b>
                                            </span>
                                        }
                                    </p>
                                </div>
                                <div class="col">
                                    <small class="alert alert-success"><b>Approx Price: @multi.GetTotalPrice()</b></small>
                                </div>
                            </div>
                        </div>
</a>
                </li>
            }
            </ul>
    </div>
        
</div>


